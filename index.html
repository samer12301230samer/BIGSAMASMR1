<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø´Ø§Øª</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø³Ù…Ø§ÙŠÙ„Ø§Øª */
        .emoji-picker {
            display: none; /* Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„ØªØ¹Ø¨ÙŠØ±ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ */
            flex-wrap: wrap;
            max-width: 300px; /* Ø¹Ø±Ø¶ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
            border: 1px solid #ccc;
            background-color: #f9f9f9; /* Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ Ù„Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
            padding: 10px; /* Ø­Ø´ÙˆØ© Ø¯Ø§Ø®Ù„ÙŠØ© */
            border-radius: 5px; /* Ø²ÙˆØ§ÙŠØ§ Ù…Ø³ØªØ¯ÙŠØ±Ø© */
            position: absolute; /* Ø¬Ø¹Ù„Ù‡Ø§ Ø¹Ø§Ø¦Ù…Ø© */
            z-index: 2; /* Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ±Ù‡Ø§ ÙÙˆÙ‚ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø®Ø±Ù‰ */
        }

        .emoji {
            cursor: pointer;
            margin: 3px;
            font-size: 24px; /* Ø­Ø¬Ù… Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª */
        #log {
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 300px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø³Ø¬Ù„ */
            overflow-y: auto;
            background: url('https://www.albayan.ae/assets/archives/images/2010/07/23/34750.gif') no-repeat center center; /* Ø±Ø§Ø¨Ø· Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù„Ù… ÙÙ„Ø³Ø·ÙŠÙ† Ù…ØªØ­Ø±Ùƒ */
            background-size: cover; /* ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø®Ù„ÙÙŠØ© */
            margin-top: 20px; /* Ù…Ø³Ø§ÙØ© Ø¹Ù„ÙˆÙŠØ© Ø¨ÙŠÙ† Ø§Ù„Ø³Ø¬Ù„ ÙˆØ¨Ø§Ù‚ÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ± */
            position: absolute; /* Ø¬Ø¹Ù„ Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ù†Øµ */
            right: 0; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„ÙŠÙ…ÙŠÙ† */
            width: 300px; /* Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„ */
            z-index: 1; /* Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ø¬Ù„ ÙÙˆÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù„Ø­Ø§ÙˆÙŠØ© */
        .chat-container {
            position: relative; /* Ø¬Ø¹Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ù†Ø³Ø¨ÙŠØ© Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ø³Ù…Ø§ÙŠÙ„Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ */
        }

        /* ØªØ­Ø³ÙŠÙ† ÙˆØ§Ø¬Ù‡Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #name-form {
            background-color: #f8f9fa;
            border: 1px solid #ced4da;
            border-radius: 10px;
            padding: 20px;
            width: 300px;
            margin: 100px auto; /* Ù„Ø¶Ù…Ø§Ù† ØªÙ…Ø±ÙƒØ² Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        #name-form h2 {
            text-align: center;
            color: #343a40;
        }

        #name-form input,
        #name-form select,
        #name-form button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-family: 'Arial', sans-serif;
        }

        #name-form button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        #name-form button:hover {
            background-color: #0056b3; /* Ù„ÙˆÙ† Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù„ÙŠÙ‡ */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø®Ø·Ø£ */
        .error-message {
            color: #e3342f; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ */
            text-align: center;
            margin-top: 10px;
        }

        /* Ø¨Ù‚ÙŠØ© Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø§Ù„Ø£Ø®Ø±Ù‰ */
        /* ØªÙ†Ø³ÙŠÙ‚ Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØºØ§Ù†ÙŠ */
        #music-container {
            margin-top: 20px;
        }

        #youtube-player {
            width: 100%;
            height: 200px;
            border: none;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            padding: 8px;
            border-radius: 5px;
            margin: 5px 0;
            display: inline-block;
            position: relative;
            color: #ffffff; /* Ù†Øµ Ø£Ø¨ÙŠØ¶ */
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø·Ø§Ø± Ø­ÙˆÙ„ Ø§Ù„Ù†ØµÙˆØµ */
        .message:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid;
            border-radius: 5px;
            transition: all 0.3s;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div id="name-form" class="name-form">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" />
            <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" />
            <select id="gender">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
                <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
                <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
            </select>
            <button id="submit-name">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <p id="error-message" class="error-message"></p>
        </div>

        <div id="chat-window" class="chat-window" style="display:none;">
            <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ ÙÙŠ ØºØ±ÙØ© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</h2>
            <div id="user-list"></div> <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
            <div class="messages" id="messages"></div>
            <input type="text" id="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§" />
            <button id="send">Ø¥Ø±Ø³Ø§Ù„</button>
            <button id="emoji-toggle">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„ØªØ¹Ø¨ÙŠØ±ÙŠØ©</button>
            <div id="log-container">
                <button id="clear-log">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button> <!-- Ø²Ø± Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ -->
                <div id="log"></div> <!-- Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø±ÙƒØ§Øª -->
            </div>
            <div id="emoji-picker" class="emoji-picker">
                <span class="emoji" onclick="addEmoji('ğŸ˜Š')">ğŸ˜Š</span>
                <span class="emoji" onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
                <span class="emoji" onclick="addEmoji('ğŸ˜¢')">ğŸ˜¢</span>
                <span class="emoji" onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
                <span class="emoji" onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
                <span class="emoji" onclick="addEmoji('ğŸ˜¡')">ğŸ˜¡</span>
                <span class="emoji" onclick="addEmoji('ğŸ¥³')">ğŸ¥³</span>
                <span class="emoji" onclick="addEmoji('ğŸ‘')">ğŸ‘</span>
                <span class="emoji" onclick="addEmoji('ğŸ‘')">ğŸ‘</span>
                <span class="emoji" onclick="addEmoji('ğŸ‰')">ğŸ‰</span>
                <span class="emoji" onclick="addEmoji('â¤ï¸')">â¤ï¸</span>
                <span class="emoji" onclick="addEmoji('ğŸ’”')">ğŸ’”</span>
                <span class="emoji" onclick="addEmoji('âœ¨')">âœ¨</span>
            </div>

            <!-- Ù‚Ø³Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ -->
            <div id="music-container">
                <h3>ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØºØ§Ù†ÙŠ</h3>
                <input type="text" id="youtube-link" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ Ù‡Ù†Ø§" />
                <button id="play-music">ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØºÙ†ÙŠØ©</button>
                <iframe id="youtube-player" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <audio id="send-sound" src="sounds/sendSound.mp3" preload="auto"></audio> <!-- Ø¥Ø¶Ø§ÙØ© ØµÙˆØª Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
    <audio id="log-sound" src="sounds/mySound.mp3" preload="auto"></audio> <!-- Ø¥Ø¶Ø§ÙØ© ØµÙˆØª -->

    <script>
        const usersDatabase = {};
        const usersInChat = {}; // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ† ÙÙŠ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©

        // Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø±ÙƒØ§Øª
        const activityLog = [];

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† localStorage
        const savedUsers = JSON.parse(localStorage.getItem('usersDatabase'));
        if (savedUsers) {
            Object.assign(usersDatabase, savedUsers);
        }

        // Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙŠÙ† Ø¨Ø§Ù„ÙØ¹Ù„
        window.onload = function() {
            const activeUsers = JSON.parse(localStorage.getItem('activeUsers')) || {};
            Object.keys(activeUsers).forEach(username => {
                if (activeUsers[username]) {
                    usersInChat[username] = true; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
                }
            });
            updateUserList(); // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            messages.forEach(msg => {
                displayMessage(msg.username, msg.message, msg.time);
            });
        };

        let currentUsername = '';

        // ÙˆØ¸ÙŠÙØ© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function validateUsername(username) {
            if (username.trim() === '') {
                return { valid: false, message: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….' };
            }
            return { valid: true };
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        document.getElementById('submit-name').addEventListener('click', function () {
            const usernameInput = document.getElementById('username').value;
            const passwordInput = document.getElementById('password').value;
            const genderInput = document.getElementById('gender').value;
            const usernameResult = validateUsername(usernameInput);

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
            document.getElementById('error-message').innerText = '';

            if (!usernameResult.valid) {
                document.getElementById('error-message').innerText = usernameResult.message;
            } else {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„Ø§Ù‹ Ø¨Ø§Ù„ÙØ¹Ù„
                if (usersDatabase[usernameInput]) {
                    // ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                    if (usersDatabase[usernameInput] !== passwordInput) {
                        document.getElementById('error-message').innerText = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.';
                    } else {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØµØ­ÙŠØ­Ø©
                        loginUser(usernameInput);
                    }
                } else {
                    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„Ø§Ù‹ØŒ Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØªÙ‡
                    usersDatabase[usernameInput] = passwordInput;
                    localStorage.setItem('usersDatabase', JSON.stringify(usersDatabase));
                    loginUser(usernameInput);
                }
            }
        });

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function loginUser(username) {
            currentUsername = username;

            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
            const activeUsers = JSON.parse(localStorage.getItem('activeUsers')) || {};
            activeUsers[currentUsername] = true; // ÙŠØ¹ØªØ¨Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø·
            localStorage.setItem('activeUsers', JSON.stringify(activeUsers));

            // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·
            logActivity(`${currentUsername} Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØºØ±ÙØ©`);
            
            // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Ù…Ù† Ø§Ù„Ø¨ÙˆØª
            displayMessage("Ø¨ÙˆØª Ø§Ù„ØªØ±Ø­ÙŠØ¨", `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${currentUsername}! Ø´ÙƒØ±Ù‹Ø§ Ù„Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©. Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© Ù…Ù…ØªØ¹Ø©!`, new Date().toLocaleTimeString());

            document.getElementById('name-form').style.display = 'none';
            document.getElementById('chat-window').style.display = 'block';

            usersInChat[currentUsername] = true; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            updateUserList(); // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        }

        // ÙˆØ¸ÙŠÙØ© Ù„ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ø´Ø§Øª
        function updateUserList() {
            const userList = document.getElementById('user-list');
            userList.innerHTML = ''; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            Object.keys(usersInChat).forEach(username => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item online';
                userItem.innerText = username;
                
                userList.appendChild(userItem);
            });
        }

        // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        function sendMessage() {
            const messageInput = document.getElementById('message').value;
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙØ§Ø±ØºØ©ØŒ ÙÙ‚Ø· Ø£Ø±Ø¬Ø¹ Ø¨Ø¯ÙˆÙ† Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø£ÙŠ Ø´ÙŠØ¡
            if (messageInput.trim() === '') {
                return;
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
            const currentTime = new Date();
            const hours = currentTime.getHours().toString().padStart(2, '0');
            const minutes = currentTime.getMinutes().toString().padStart(2, '0');
            const formattedTime = `${hours}:${minutes}`;

            // Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ localStorage
            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            messages.push({username: currentUsername, message: messageInput, time: formattedTime});
            localStorage.setItem('messages', JSON.stringify(messages));

            displayMessage(currentUsername, messageInput, formattedTime); // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('message').value = ''; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©

            // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const sendSound = document.getElementById('send-sound');
            sendSound.play();
        }

        // ÙˆØ¸ÙŠÙØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        function displayMessage(username, message, time) {
            const messagesDiv = document.getElementById('messages');
            const messageElement = document.createElement('div'); // Ø§Ø³ØªØ®Ø¯Ø§Ù… div Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† p Ù„Ø§Ø­ØªÙˆØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ²Ø± Ø§Ù„Ø­Ø°Ù
            messageElement.id = `msg-${Date.now()}`; // Ø¥Ø¹Ø·Ø§Ø¡ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø±Ø³Ø§Ù„Ø©

            // ØªÙˆÙ„ÙŠØ¯ Ù„ÙˆÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„Ø£ØµÙØ± ÙˆØ§Ù„Ø£Ø®Ø¶Ø±
            let randomColor;
            do {
                randomColor = `#${Math.floor(Math.random() * 16777215).toString(16)}`;
            } while (randomColor === '#ffff00' || randomColor === '#00ff00'); // Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ù„ÙˆÙ†ÙŠÙ† Ø§Ù„Ø£ØµÙØ± ÙˆØ§Ù„Ø£Ø®Ø¶Ø±

            // Ø¥Ø¶Ø§ÙØ© ØªØ¹Ø¯ÙŠÙ„ Ù„Ø¬Ø¹Ù„ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ø§Ù…Ø¹ Ù…Ø¹ Ø¥Ø·Ø§Ø± Ù…Ù„ÙˆÙ†
            messageElement.innerHTML = `<span class="username">${username}:</span> <span class="message" style="color:${randomColor};">${message}</span> <span style="font-size: smaller;">(${time})</span>`;
            
            // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ù„Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            const deleteButton = document.createElement('button');
            deleteButton.innerText = 'Ø­Ø°Ù';
            deleteButton.onclick = function() {
                messagesDiv.removeChild(messageElement); // Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                logActivity(`Ø±Ø³Ø§Ù„Ø© Ù…Ù† ${username} ØªÙ… Ø­Ø°ÙÙ‡Ø§.`); // Ø³Ø¬Ù„ Ø§Ù„Ø­Ø°Ù
            };
            messageElement.appendChild(deleteButton);

            messagesDiv.appendChild(messageElement);
            messagesDiv.scrollTop = messagesDiv.scrollHeight; // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø³ÙÙ„

            // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
            document.getElementById('log-sound').play(); 
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©
            logActivity(`Ø±Ø³Ø§Ù„Ø© Ù…Ù† ${username} ØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§: "${message}"`);
        }

        // ÙˆØ¸ÙŠÙØ© Ù„Ù…Ø³Ø­ ÙƒØ§Ù…Ù„ Ø§Ù„Ø³Ø¬Ù„
        document.getElementById('clear-log').addEventListener('click', function() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ')) {
                const logDiv = document.getElementById('log');
                logDiv.innerHTML = ''; // Ù…Ø³Ø­ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø¬Ù„
                logActivity('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.'); // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
            }
        });

        // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¥Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        function addEmoji(emoji) {
            document.getElementById('message').value += emoji; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø¥Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø¥Ø±Ø³Ø§Ù„
        document.getElementById('send').addEventListener('click', function() {
            sendMessage();
        });

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Enter" ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        document.getElementById('message').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                sendMessage(); // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Enter"
            }
        });

        // ÙˆØ¸ÙŠÙØ© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø·
        function logActivity(activity) {
            activityLog.push(activity);
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += `<div>${new Date().toLocaleString()}: ${activity}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight; // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø³Ø¬Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø³ÙÙ„
            
            // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
            document.getElementById('log-sound').play();
        }

        // ÙˆØ¸ÙŠÙØ© Ù„ØªØ¨Ø¯ÙŠÙ„ Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„ØªØ¹Ø¨ÙŠØ±ÙŠØ©
        document.getElementById('emoji-toggle').addEventListener('click', function() {
            const emojiPicker = document.getElementById('emoji-picker');
            emojiPicker.style.display = emojiPicker.style.display === 'none' ? 'flex' : 'none';
        });

        // ÙˆØ¸ÙŠÙØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØºÙ†ÙŠØ© Ù…Ù† Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨
        document.getElementById('play-music').addEventListener('click', function() {
            const youtubeLink = document.getElementById('youtube-link').value;
            const videoId = extractVideoId(youtubeLink);
            if (videoId) {
                document.getElementById('youtube-player').src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1`;
            } else {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ ØµØ­ÙŠØ­.');
            }
        });

        // Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨
        function extractVideoId(url) {
            const regExp = /(?:https?:\/\/)?(?:www\.)?youtube\.com\/(?:watch\?v=|embed\/|v\/|.+\?v=)?([^&\n]{11})|youtu\.be\/([^&\n]{11})/;
            const match = url.match(regExp);
            return match ? match[1] || match[2] : null;
        }

        // Ø¹Ù†Ø¯ ØºÙ„Ù‚ Ø§Ù„Ù…ØªØµÙØ­ Ø£Ùˆ Ø§Ù„Ø®Ø±ÙˆØ¬
        window.addEventListener('beforeunload', function() {
            const activeUsers = JSON.parse(localStorage.getItem('activeUsers')) || {};
            delete activeUsers[currentUsername]; // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø´Ø·
            localStorage.setItem('activeUsers', JSON.stringify(activeUsers));
        });
    </script>
</body>
</html>